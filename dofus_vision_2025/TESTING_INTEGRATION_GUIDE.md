# üß™ Guide de Test et Int√©gration - DOFUS Unity World Model AI

**Version 2025.1.0** - Documentation compl√®te des nouvelles fonctionnalit√©s

## üìã Vue d'Ensemble

Ce guide documente les nouvelles fonctionnalit√©s ajout√©es au syst√®me DOFUS Unity World Model AI, incluant les strat√©gies de test offline, l'apprentissage passif, et l'int√©gration d'applications externes.

## üöÄ D√©marrage Rapide

### Lanceur Unifi√©

```bash
# Lancement avec menu interactif
python launch_unified_system.py

# Modes directs
python launch_unified_system.py --mode tests
python launch_unified_system.py --mode passive --duration 600
python launch_unified_system.py --mode ganymede
python launch_unified_system.py --mode all
```

## üß™ Environnement de Test Synth√©tique

### Fonctionnalit√©s

- **G√©n√©ration de screenshots DOFUS simul√©s** avec interface compl√®te
- **√âtats de jeu mock√©s** pour tests sans connexion serveur
- **S√©quences coh√©rentes** d'exploration et combat
- **Base de donn√©es de test** persistante

### Utilisation

```python
from tests.test_synthetic_environment import SyntheticTestEnvironment

# Cr√©er environnement
test_env = SyntheticTestEnvironment("test_data")

# G√©n√©rer dataset complet
config = test_env.setup_complete_test_environment(
    num_screenshots=100,
    num_state_sequences=20
)

# Donn√©es disponibles dans :
# - test_data/screenshots/
# - test_data/state_sequences.json
# - test_data/test_environment_config.json
```

### Structure des Screenshots Synth√©tiques

- **Interface de combat** : Grille tactique 15x17 avec positions joueur/ennemi
- **Barres de statistiques** : HP/MP/AP avec valeurs r√©alistes
- **Barre de sorts** : 8 sorts Iop avec raccourcis clavier
- **Fen√™tre de chat** : Messages de combat simul√©s
- **M√©tadonn√©es** : Classe, niveau, √©tat combat

## üîç Mode Apprentissage Passif

### Fonctionnalit√©s

- **Capture temps r√©el** de DOFUS Unity sans interaction
- **D√©tection de patterns** : S√©quences de sorts, mouvements tactiques
- **Anti-d√©tection avanc√©e** : D√©lais variables, comportement humain
- **M√©triques temps r√©el** : FPS, qualit√© session, patterns appris

### Utilisation

```python
from core.vision_engine.passive_learning_mode import get_passive_learning_engine

# Cr√©er moteur
engine = get_passive_learning_engine()

# D√©marrer session
session_id = engine.start_passive_learning_session("IOPS", 150, "test")

# L'apprentissage se fait automatiquement
# Surveillance fen√™tre DOFUS + analyse patterns

# Arr√™ter session
session = engine.stop_passive_learning_session()

print(f"Captures: {session.total_captures}")
print(f"Patterns: {session.patterns_learned}")
print(f"Qualit√©: {session.data_quality_score}")
```

### Patterns D√©tect√©s

1. **S√©quences de sorts** : Optimisation AP/d√©g√¢ts
2. **Mouvements tactiques** : Positionnement optimal
3. **Gestion ressources** : HP/MP critique

### Configuration

```python
config = {
    "capture_interval": 0.5,        # Capture toutes les 500ms
    "max_session_duration": 3600,   # 1 heure max
    "min_confidence_threshold": 0.7,
    "save_screenshots": True,
    "pattern_detection_enabled": True,
    "anti_detection_delays": True
}
```

## üîó Connecteurs API Externes

### APIs Support√©es

#### Dofapi.fr (API non-officielle)
- **Sorts par classe** : Tous les sorts avec statistiques compl√®tes
- **Items par cat√©gorie** : Equipment, weapons, consumables
- **Recherche d'items** : Par nom avec correspondance partielle

#### Doduapi (api.dofusdu.de)
- **Encyclopedia compl√®te** : Items, sets, √©quipements
- **Multi-langue** : FR/EN support
- **Images** : URLs des ic√¥nes items

#### Ganymede Guides (ganymede-app.com)
- **Guides communautaires** : Scraping intelligent des guides DOFUS
- **Cat√©gories multiples** : Qu√™tes, donjons, m√©tiers, PvP
- **Enrichissement contextuel** : Adaptation selon classe/niveau joueur
- **Cache local SQLite** : Synchronisation et recherche rapide

### Utilisation

```python
from core.external_integration.dofus_api_connector import get_unified_api_manager

# Gestionnaire unifi√©
manager = get_unified_api_manager()

# Recherche comprehensive
response = manager.get_comprehensive_item_data("Dofus")
if response.success:
    print(f"Items trouv√©s: {len(response.data)}")

# Sorts de classe
response = manager.get_class_spells_comprehensive("iop")
if response.success:
    for spell in response.data:
        print(f"{spell['name']}: {spell['ap_cost']} AP")

# Statistiques
stats = manager.get_statistics()
print(f"Cache: {stats['cache_size']} entr√©es")

# Guides Ganymede
from core.external_integration.ganymede_guides_connector import get_ganymede_connector

ganymede = get_ganymede_connector()

# Synchroniser guides localement
stats = ganymede.sync_guides_database(categories=["quetes", "donjons"])
print(f"Guides synchronis√©s: {stats['guides_updated']}")

# Rechercher guide par sujet
guide = ganymede.get_guide_by_topic("temple obscur")
if guide:
    print(f"Guide trouv√©: {guide['title']}")
    print(f"√âtapes: {len(guide['steps'])}")

# Recherche g√©n√©rale
results = ganymede.search_guides("iop")
print(f"Guides Iop trouv√©s: {len(results)}")
```

### Cache Intelligent

- **Cache m√©moire** : 1 heure par d√©faut
- **Cache SQLite** : Persistant entre sessions
- **Mise √† jour automatique** : D√©tection changements API
- **Rate limiting** : Protection contre spam

## üïµÔ∏è Framework Reverse Engineering

### Fonctionnalit√©s

- **D√©tection processus** : Ganymede, DOFUS Guide, applications cibles
- **Capture r√©seau** : Interception trafic HTTP/HTTPS
- **Analyse comportementale** : CPU, m√©moire, fichiers ouverts
- **D√©tection APIs** : Endpoints automatiques, formats de r√©ponse

### Utilisation

```python
from core.external_integration.reverse_engineering_framework import get_reverse_engineering_framework

# Cr√©er orchestrateur
orchestrator = get_reverse_engineering_framework()

# D√©couvrir applications
processes = orchestrator.discover_target_applications()

if processes:
    # Analyser application
    analysis = orchestrator.analyze_application(
        processes[0],
        capture_duration=120
    )

    # G√©n√©rer guide d'int√©gration
    guide = orchestrator.generate_integration_guide(analysis['session_id'])
```

### Analyse R√©seau

- **Capture Scapy** : Trafic TCP/UDP sur ports communs
- **D√©tection HTTP** : Requ√™tes/r√©ponses automatiques
- **Pattern API** : JSON, REST endpoints
- **Export donn√©es** : JSON avec m√©tadonn√©es

### Recommandations Automatiques

Le syst√®me g√©n√®re automatiquement :
- **Endpoints d√©tect√©s** : URLs et m√©thodes HTTP
- **Formats de donn√©es** : JSON/XML identification
- **Connexions externes** : Services tiers utilis√©s
- **Fichiers config** : Configurations d√©couvertes

## üìä Int√©gration avec Syst√®me Existant

### Knowledge Base

```python
# Enrichissement avec APIs externes et guides Ganymede
from core.knowledge_base.knowledge_integration import get_knowledge_base

kb = get_knowledge_base()

# Les connecteurs API alimentent automatiquement la KB
# Mise √† jour sorts, items, donn√©es √©conomiques

# Interroger guides Ganymede depuis la KB
guide_result = kb.query_ganymede_guide("donjon royal")
if guide_result.success:
    guide = guide_result.data
    print(f"Guide: {guide['title']}")
    print(f"Adaptations contextuelles: {guide.get('level_adaptation', 'Aucune')}")

# Recommandations contextuelles automatiques
recommendations = kb.get_contextual_guide_recommendations()
if recommendations.success:
    for rec in recommendations.data['recommendations']:
        print(f"- {rec['topic']}: {rec['guide']['title']}")

# Synchronisation guides depuis KB
sync_stats = kb.sync_ganymede_guides(categories=["donjons", "pvp"])
print(f"Synchronisation: {sync_stats}")
```

### Learning Engine

```python
# Apprentissage passif int√©gr√©
from core.learning_engine.adaptive_learning_engine import get_learning_engine

engine = get_learning_engine()

# Les patterns d√©tect√©s en mode passif enrichissent l'apprentissage
# Optimisation automatique des strat√©gies
```

### HRM Integration

```python
# Donn√©es externes dans les d√©cisions
from core.world_model.hrm_dofus_integration import DofusIntelligentDecisionMaker

decision_maker = DofusIntelligentDecisionMaker()

# Utilise APIs externes pour contexte enrichi
# Recommandations bas√©es sur donn√©es communautaires
```

## üîß Configuration Avanc√©e

### Variables d'Environnement

```bash
# APIs externes
export DOFAPI_CACHE_DURATION=3600
export DODUAPI_LANGUAGE=fr

# Apprentissage passif
export PASSIVE_CAPTURE_INTERVAL=0.5
export PASSIVE_MAX_DURATION=7200

# Reverse engineering
export RE_CAPTURE_PORTS="80,443,8080,8443"
export RE_OUTPUT_DIR="reverse_data"
```

### Fichiers de Configuration

#### `config/api_settings.json`
```json
{
  "dofapi": {
    "base_url": "https://api.dofapi.fr",
    "timeout": 10,
    "cache_duration": 3600
  },
  "doduapi": {
    "base_url": "https://api.dofusdu.de",
    "timeout": 15,
    "cache_duration": 3600
  }
}
```

#### `config/passive_learning.json`
```json
{
  "capture_settings": {
    "interval": 0.5,
    "max_screenshots": 1000,
    "save_screenshots": true
  },
  "pattern_detection": {
    "enabled": true,
    "min_confidence": 0.7,
    "spell_sequences": true,
    "movement_patterns": true
  }
}
```

## üö® S√©curit√© et Anti-D√©tection

### Apprentissage Passif

- **Vision uniquement** : Aucune interaction avec le jeu
- **D√©lais humanis√©s** : Randomisation des timings
- **Capture respectueuse** : Limitation FPS, ressources
- **Logs s√©curis√©s** : Aucune donn√©e sensible

### Reverse Engineering

- **Analyse locale** : Aucune donn√©e transmise
- **Permissions utilisateur** : Respect des droits d'acc√®s
- **Capture √©thique** : Applications utilisateur uniquement
- **Anonymisation** : Donn√©es personnelles exclues

## üìà M√©triques et Monitoring

### Dashboard Temps R√©el

```python
# M√©triques apprentissage passif
metrics = engine.get_current_metrics()
print(f"Captures/min: {metrics['real_time_metrics']['captures_per_minute']}")
print(f"Patterns: {metrics['patterns_learned']}")
print(f"Qualit√©: {metrics['real_time_metrics']['session_quality']}")

# Statistiques APIs
stats = manager.get_statistics()
print(f"Requ√™tes Dofapi: {stats['current_session']['dofapi_requests']}")
print(f"Cache hits: {stats['current_session']['cache_hits']}")
```

### Logging Avanc√©

- **Niveaux configurables** : DEBUG, INFO, WARNING, ERROR
- **Rotation automatique** : Fichiers journaliers
- **M√©triques performance** : Temps r√©ponse, erreurs
- **Alertes syst√®me** : Seuils configurable

## üîÑ Workflow Recommand√©

### 1. Test Initial
```bash
python launch_unified_system.py --mode tests
```

### 2. Environnement Synth√©tique
```bash
python launch_unified_system.py --mode synthetic
```

### 3. Apprentissage Passif
```bash
# D√©marrer DOFUS Unity puis :
python launch_unified_system.py --mode passive --duration 900
```

### 4. Tests Guides Ganymede
```bash
python launch_unified_system.py --mode ganymede
```

### 5. Analyse Applications (Optionnel)
```bash
# D√©marrer Ganymede/DOFUS Guide puis :
python launch_unified_system.py --mode reverse
```

### 6. Interface Compl√®te
```bash
python launch_unified_system.py --mode gui
```

## üêõ D√©pannage

### Probl√®mes Courants

#### Apprentissage Passif
- **Fen√™tre DOFUS non trouv√©e** : V√©rifier que DOFUS Unity est ouvert
- **Captures vides** : Ajuster seuils de confiance OCR
- **Performance lente** : R√©duire fr√©quence capture

#### APIs Externes
- **Timeouts** : V√©rifier connexion internet
- **Rate limiting** : Respecter d√©lais entre requ√™tes
- **Cache corrompu** : Supprimer `external_apis_cache.db`

#### Guides Ganymede
- **Guides non trouv√©s** : V√©rifier connexion internet et URL ganymede-app.com
- **Scraping √©choue** : Structure HTML peut avoir chang√©, v√©rifier logs
- **Cache corrompu** : Supprimer `ganymede_guides_cache.json` et `ganymede_knowledge.db`

#### Reverse Engineering
- **Privil√®ges insuffisants** : Lancer en administrateur
- **Processus non d√©tect√©s** : V√©rifier noms dans `target_processes`
- **Capture r√©seau √©choue** : Installer Npcap/WinPcap

### Commandes Debug

```bash
# Tests avec logs d√©taill√©s
python -u tests/test_complete_system.py 2>&1 | tee debug.log

# Mode passif debug
python -c "
from core.vision_engine.passive_learning_mode import get_passive_learning_engine
engine = get_passive_learning_engine()
# Activer debug logging
import logging
logging.basicConfig(level=logging.DEBUG)
"
```

## üöÄ Performances

### Optimisations AMD 7800XT

- **DirectML** : Acc√©l√©ration IA native Windows
- **ROCm fallback** : Support Linux/Docker
- **Cache GPU** : R√©utilisation mod√®les charg√©s
- **Batch processing** : Traitement par lots optimis√©

### M√©triques Typiques

- **Apprentissage passif** : 2-3 FPS capture, <100MB RAM
- **APIs externes** : <200ms latence, 95% cache hit
- **Reverse engineering** : 1000+ paquets/min analys√©s
- **Tests synth√©tiques** : 50 screenshots/5s g√©n√©ration

## üìö R√©f√©rences

### Documentation Technique
- [API Reference](API_REFERENCE.md) - R√©f√©rence compl√®te des APIs
- [Architecture](ARCHITECTURE.md) - Architecture syst√®me d√©taill√©e
- [Performance](PERFORMANCE.md) - Optimisations et benchmarks

### APIs Externes
- [Dofapi Documentation](https://dofapi.fr) - API non-officielle DOFUS
- [Doduapi GitHub](https://github.com/dofusdude/doduapi) - API encyclopedia ouverte

### Outils Reverse Engineering
- [Scapy Documentation](https://scapy.net) - Capture et analyse r√©seau
- [Burp Suite](https://portswigger.net/burp) - Proxy web pour APIs

---

## üéØ Conclusion

Les nouvelles fonctionnalit√©s transforment le syst√®me en une plateforme compl√®te de test, apprentissage et int√©gration pour DOFUS Unity. L'approche modulaire permet une utilisation flexible selon les besoins sp√©cifiques.

**Points Cl√©s :**
- ‚úÖ **Tests offline complets** sans connexion serveur
- ‚úÖ **Apprentissage passif s√©curis√©** avec anti-d√©tection
- ‚úÖ **Int√©gration APIs communautaires** automatique
- ‚úÖ **Reverse engineering √©thique** applications tierces
- ‚úÖ **Lanceur unifi√©** pour tous les modes

**Prochaines √âtapes :**
1. Tester chaque mode individuellement
2. Configurer selon vos besoins sp√©cifiques
3. Int√©grer dans votre workflow de d√©veloppement
4. Monitorer les performances et ajuster

> *"L'intelligence artificielle au service de l'excellence tactique DOFUS"* üéÆü§ñ